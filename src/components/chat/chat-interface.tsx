'use client';

import { useState, useRef, useEffect, FormEvent } from 'react';
import { Send, Ticket, MessageCircleQuestion } from 'lucide-react';
import { AnimatePresence, motion } from 'framer-motion';

import { cn } from '@/lib/utils';
import type { Message, TicketOrder } from '@/lib/types';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { ChatBubble } from './chat-bubble';
import { Calendar } from '../ui/calendar';
import { TicketSummary } from './ticket-summary';
import { PaymentDialog } from './payment-dialog';
import { DigitalTicket } from './digital-ticket';
import { getAnswer } from '@/ai/flows/faq-flow';

const translations = {
  en: {
    welcome: "Hello! I'm Museum Buddy. How can I help you today? You can ask me anything or switch to 'Ticket Booking' to buy tickets.",
    welcomeBooking: 'Welcome to Ticket Booking. Please select a state to begin.',
    welcomeFaq: 'You can ask me anything about museums or general topics.',
    bookingMode: 'Ticket Booking',
    faqMode: 'Ask a Question',
    askMeAnything: 'Ask me anything...',
    selectState: 'Great! Please select a state to see available museums.',
    selectMuseum: 'Awesome! Please select a museum from the list.',
    chooseExperience: 'Great! Which experience are you interested in?',
    generalAdmission: 'General Admission',
    specialExhibition: 'Special Exhibition: "Cosmos"',
    selectDate: 'Please select a date for your visit.',
    selectTime: 'Excellent! Please select a time slot.',
    selectQuantity: 'How many tickets do you need?',
    adult: 'Adult',
    child: 'Child',
    proceedToPayment: 'Proceed to Payment',
    orderSummary: 'Here is your order summary:',
    paymentSuccessful: 'Payment successful! ЁЯОЙ',
    ticketIssued: 'Your digital ticket is ready. We look forward to seeing you!',
    times: ['10:00 AM', '12:00 PM', '2:00 PM', '4:00 PM'],
    states: {
        'Delhi': ['National Museum, New Delhi'],
        'West Bengal': ['Indian Museum, Kolkata'],
        'Telangana': ['Salar Jung Museum, Hyderabad'],
        'Maharashtra': ['Chhatrapati Shivaji Maharaj Vastu Sangrahalaya, Mumbai'],
        'Karnataka': ['Visvesvaraya Industrial & Technological Museum, Bengaluru'],
        'Tamil Nadu': ['Government Museum, Chennai'],
        'Rajasthan': ['Albert Hall Museum, Jaipur'],
        'Uttar Pradesh': ['Anand Bhavan Museum, Prayagraj'],
        'Gujarat': ['Calico Museum of Textiles, Ahmedabad'],
    },
  },
  hi: {
    welcome: 'рдирдорд╕реНрддреЗ! рдореИрдВ рдореНрдпреВрдЬрд┐рдпрдо рдмрдбреА рд╣реВрдВред рдореИрдВ рдЖрдЬ рдЖрдкрдХреА рдХреИрд╕реЗ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ? рдЖрдк рдореБрдЭрд╕реЗ рдХреБрдЫ рднреА рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЯрд┐рдХрдЯ рдЦрд░реАрджрдиреЗ рдХреЗ рд▓рд┐рдП \'рдЯрд┐рдХрдЯ рдмреБрдХрд┐рдВрдЧ\' рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред',
    welcomeBooking: 'рдЯрд┐рдХрдЯ рдмреБрдХрд┐рдВрдЧ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИред рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ рдПрдХ рд░рд╛рдЬреНрдп рдЪреБрдиреЗрдВред',
    welcomeFaq: 'рдЖрдк рдореБрдЭрд╕реЗ рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдпреЛрдВ рдпрд╛ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рд╖рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВред',
    bookingMode: 'рдЯрд┐рдХрдЯ рдмреБрдХрд┐рдВрдЧ',
    faqMode: 'рдкреНрд░рд╢реНрди рдкреВрдЫреЗрдВ',
    askMeAnything: 'рдореБрдЭрд╕реЗ рдХреБрдЫ рднреА рдкреВрдЫреЗрдВ...',
    selectState: 'рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛! рдЙрдкрд▓рдмреНрдз рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдпреЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ рдПрдХ рд░рд╛рдЬреНрдп рдЪреБрдиреЗрдВред',
    selectMuseum: 'рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛! рдХреГрдкрдпрд╛ рд╕реВрдЪреА рдореЗрдВ рд╕реЗ рдПрдХ рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп рдЪреБрдиреЗрдВред',
    chooseExperience: 'рдмрдврд╝рд┐рдпрд╛! рдЖрдк рдХрд┐рд╕ рдЕрдиреБрднрд╡ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ?',
    generalAdmission: 'рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рд╡реЗрд╢',
    specialExhibition: 'рд╡рд┐рд╢реЗрд╖ рдкреНрд░рджрд░реНрд╢рдиреА: "рдХреЙрд╕рдореЙрд╕"',
    selectDate: 'рдХреГрдкрдпрд╛ рдЕрдкрдиреА рдпрд╛рддреНрд░рд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рддрд╛рд░реАрдЦ рдЪреБрдиреЗрдВред',
    selectTime: 'рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛! рдХреГрдкрдпрд╛ рдПрдХ рд╕рдордп рд╕реНрд▓реЙрдЯ рдЪреБрдиреЗрдВред',
    selectQuantity: 'рдЖрдкрдХреЛ рдХрд┐рддрдиреЗ рдЯрд┐рдХрдЯ рдЪрд╛рд╣рд┐рдП?',
    adult: 'рд╡рдпрд╕реНрдХ',
    child: 'рдмрдЪреНрдЪрд╛',
    proceedToPayment: 'рднреБрдЧрддрд╛рди рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝реЗрдВ',
    orderSummary: 'рдпрд╣ рдЖрдкрдХреЗ рдЖрджреЗрд╢ рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рд╣реИ:',
    paymentSuccessful: 'рднреБрдЧрддрд╛рди рд╕рдлрд▓! ЁЯОЙ',
    ticketIssued: 'рдЖрдкрдХрд╛ рдбрд┐рдЬрд┐рдЯрд▓ рдЯрд┐рдХрдЯ рддреИрдпрд╛рд░ рд╣реИред рд╣рдо рдЖрдкрдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрддреНрд╕реБрдХ рд╣реИрдВ!',
    times: ['рд╕реБрдмрд╣ 10:00', 'рджреЛрдкрд╣рд░ 12:00', 'рджреЛрдкрд╣рд░ 2:00', 'рд╢рд╛рдо 4:00'],
    states: {
      'рджрд┐рд▓реНрд▓реА': ['рд░рд╛рд╖реНрдЯреНрд░реАрдп рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рдирдИ рджрд┐рд▓реНрд▓реА'],
      'рдкрд╢реНрдЪрд┐рдо рдмрдВрдЧрд╛рд▓': ['рднрд╛рд░рддреАрдп рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рдХреЛрд▓рдХрд╛рддрд╛'],
      'рддреЗрд▓рдВрдЧрд╛рдирд╛': ['рд╕рд╛рд▓рд╛рд░ рдЬрдВрдЧ рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рд╣реИрджрд░рд╛рдмрд╛рдж'],
      'рдорд╣рд╛рд░рд╛рд╖реНрдЯреНрд░': ['рдЫрддреНрд░рдкрддрд┐ рд╢рд┐рд╡рд╛рдЬреА рдорд╣рд╛рд░рд╛рдЬ рд╡рд╛рд╕реНрддреБ рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рдореБрдВрдмрдИ'],
      'рдХрд░реНрдирд╛рдЯрдХ': ['рд╡рд┐рд╢реНрд╡реЗрд╢реНрд╡рд░реИрдпрд╛ рдФрджреНрдпреЛрдЧрд┐рдХ рдФрд░ рддрдХрдиреАрдХреА рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рдмреЗрдВрдЧрд▓реБрд░реБ'],
      'рддрдорд┐рд▓рдирд╛рдбреБ': ['рд╕рд░рдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рдЪреЗрдиреНрдирдИ'],
      'рд░рд╛рдЬрд╕реНрдерд╛рди': ['рдЕрд▓реНрдмрд░реНрдЯ рд╣реЙрд▓ рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рдЬрдпрдкреБрд░'],
      'рдЙрддреНрддрд░ рдкреНрд░рджреЗрд╢': ['рдЖрдирдВрдж рднрд╡рди рд╕рдВрдЧреНрд░рд╣рд╛рд▓рдп, рдкреНрд░рдпрд╛рдЧрд░рд╛рдЬ'],
      'рдЧреБрдЬрд░рд╛рдд': ['рдХреИрд▓рд┐рдХреЛ рдореНрдпреВрдЬрд┐рдпрдо рдСрдл рдЯреЗрдХреНрд╕рдЯрд╛рдЗрд▓реНрд╕, рдЕрд╣рдорджрд╛рдмрд╛рдж'],
    }
  },
  bn: {
    welcome: 'ржиржорж╕рзНржХрж╛рж░! ржЖржорж┐ ржорж┐ржЙржЬрж┐ржпрж╝рж╛ржо ржмрж╛ржбрж┐ред ржЖржорж┐ ржЖржЬ ржЖржкржирж╛ржХрзЗ ржХрж┐ржнрж╛ржмрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рждрзЗ ржкрж╛рж░рж┐? ржЖржкржирж┐ ржЖржорж╛ржХрзЗ ржХрж┐ржЫрзБ ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржЕржержмрж╛ ржЯрж┐ржХрж┐ржЯ ржХрзЗржирж╛рж░ ржЬржирзНржп \'ржЯрж┐ржХрж┐ржЯ ржмрзБржХрж┐ржВ\' ржП рж╕рзНржпрзБржЗржЪ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред',
    welcomeBooking: 'ржЯрж┐ржХрж┐ржЯ ржмрзБржХрж┐ржВржпрж╝рзЗ рж╕рзНржмрж╛ржЧрждржоред рж╢рзБрж░рзБ ржХрж░рждрзЗ ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржПржХржЯрж┐ рж░рж╛ржЬрзНржп ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред',
    welcomeFaq: 'ржЖржкржирж┐ ржЖржорж╛рж░ ржХрж╛ржЫрзЗ ржЬрж╛ржжрзБржШрж░ ржмрж╛ рж╕рж╛ржзрж╛рж░ржг ржмрж┐рж╖ржпрж╝ рж╕ржорзНржкрж░рзНржХрзЗ ржХрж┐ржЫрзБ ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред',
    bookingMode: 'ржЯрж┐ржХрж┐ржЯ ржмрзБржХрж┐ржВ',
    faqMode: 'ржкрзНрж░рж╢рзНржи ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рзБржи',
    askMeAnything: 'ржЖржорж╛ржХрзЗ ржХрж┐ржЫрзБ ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рзБржи...',
    selectState: 'ржжрж╛рж░рзБржг! ржЙржкрж▓ржмрзНржз ржЬрж╛ржжрзБржШрж░ ржжрзЗржЦрждрзЗ ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржПржХржЯрж┐ рж░рж╛ржЬрзНржп ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред',
    selectMuseum: 'ржжрж╛рж░рзБржг! ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ рждрж╛рж▓рж┐ржХрж╛ ржерзЗржХрзЗ ржПржХржЯрж┐ ржЬрж╛ржжрзБржШрж░ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред',
    chooseExperience: 'ржжрж╛рж░рзБржг! ржЖржкржирж┐ ржХрзЛржи ╪к╪м╪▒╪ирж╛ржпрж╝ ржЖржЧрзНрж░рж╣рзА?',
    generalAdmission: 'рж╕рж╛ржзрж╛рж░ржг ржнрж░рзНрждрж┐',
    specialExhibition: 'ржмрж┐рж╢рзЗрж╖ ржкрзНрж░ржжрж░рзНрж╢ржирзА: "ржХрж╕ржорж╕"',
    selectDate: 'ржЖржкржирж╛рж░ ржкрж░рж┐ржжрж░рзНрж╢ржирзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ рждрж╛рж░рж┐ржЦ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред',
    selectTime: 'ржЪржорзОржХрж╛рж░! ржПржХржЯрж┐ рж╕ржоржпрж╝ рж╕рзНрж▓ржЯ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред',
    selectQuantity: 'ржЖржкржирж╛рж░ ржХрждржЧрзБрж▓рзЛ ржЯрж┐ржХрж┐ржЯ рж▓рж╛ржЧржмрзЗ?',
    adult: 'ржкрзНрж░рж╛ржкрзНрждржмржпрж╝рж╕рзНржХ',
    child: 'рж╢рж┐рж╢рзБ',
    proceedToPayment: 'ржкрзЗржорзЗржирзНржЯрзЗрж░ ржЬржирзНржп ржПржЧрж┐ржпрж╝рзЗ ржпрж╛ржи',
    orderSummary: 'ржПржЦрж╛ржирзЗ ржЖржкржирж╛рж░ ржЕрж░рзНржбрж╛рж░рзЗрж░ рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк:',
    paymentSuccessful: 'ржкрзЗржорзЗржирзНржЯ рж╕ржлрж▓! ЁЯОЙ',
    ticketIssued: 'ржЖржкржирж╛рж░ ржбрж┐ржЬрж┐ржЯрж╛рж▓ ржЯрж┐ржХрж┐ржЯ ржкрзНрж░рж╕рзНрждрзБрждред ржЖржорж░рж╛ ржЖржкржирж╛ржХрзЗ ржжрзЗржЦрж╛рж░ ржЬржирзНржп ржЙржирзНржорзБржЦ!',
    times: ['рж╕ржХрж╛рж▓ рззрзж:рзжрзж', 'ржжрзБржкрзБрж░ рззрзи:рзжрзж', 'ржжрзБржкрзБрж░ рзи:рзжрзж', 'ржмрж┐ржХрж╛рж▓ рзк:рзжрзж'],
    states: {
        'ржжрж┐рж▓рзНрж▓рж┐': ['ржЬрж╛рждрзАржпрж╝ ржЬрж╛ржжрзБржШрж░, ржирждрзБржи ржжрж┐рж▓рзНрж▓рж┐'],
        'ржкрж╢рзНржЪрж┐ржоржмржЩрзНржЧ': ['ржнрж╛рж░рждрзАржпрж╝ ржЬрж╛ржжрзБржШрж░, ржХрж▓ржХрж╛рждрж╛'],
        'рждрзЗрж▓рзЗржЩрзНржЧрж╛ржирж╛': ['рж╕рж╛рж▓рж╛рж░ ржЬржВ ржЬрж╛ржжрзБржШрж░, рж╣рж╛ржпрж╝ржжрзНрж░рж╛ржмрж╛ржж'],
        'ржорж╣рж╛рж░рж╛рж╖рзНржЯрзНрж░': ['ржЫрждрзНрж░ржкрждрж┐ рж╢рж┐ржмрж╛ржЬрзА ржорж╣рж╛рж░рж╛ржЬ рд╡рд╛рд╕реНрддреБ рж╕ржВржЧрзНрж░рж╣рж╛рж▓ржпрж╝, ржорзБржорзНржмрж╛ржЗ'],
        'ржХрж░рзНржгрж╛ржЯржХ': ['ржмрж┐рж╢рзНржмрзЗрж╢рзНржмрж░рж╛ржпрж╝ рж╢рж┐рж▓рзНржк ржУ ржкрзНрж░ржпрзБржХрзНрждрж┐ржЧржд ржЬрж╛ржжрзБржШрж░, ржмрзЗржЩрзНржЧрж╛рж▓рзБрж░рзБ'],
        'рждрж╛ржорж┐рж▓ржирж╛ржбрж╝рзБ': ['рж╕рж░ржХрж╛рж░рж┐ ржЬрж╛ржжрзБржШрж░, ржЪрзЗржирзНржирж╛ржЗ'],
        'рж░рж╛ржЬрж╕рзНржерж╛ржи': ['ржЕрзНржпрж╛рж▓ржмрж╛рж░рзНржЯ рж╣рж▓ ржЬрж╛ржжрзБржШрж░, ржЬржпрж╝ржкрзБрж░'],
        'ржЙрждрзНрждрж░ржкрзНрж░ржжрзЗрж╢': ['ржЖржиржирзНржж ржнржмржи ржЬрж╛ржжрзБржШрж░, ржкрзНрж░ржпрж╝рж╛ржЧрж░рж╛ржЬ'],
        'ржЧрзБржЬрж░рж╛ржЯ': ['ржХрзНржпрж╛рж▓рж┐ржХрзЛ ржЯрзЗржХрзНрж╕ржЯрж╛ржЗрж▓ ржорж┐ржЙржЬрж┐ржпрж╝рж╛ржо, ржЖрж╣ржорзЗржжрж╛ржмрж╛ржж'],
    }
  },
  ta: {
    welcome: 'ро╡рогроХрпНроХроорпН! роиро╛ройрпН рооро┐ропрпВроЪро┐ропроорпН рокроЯро┐. роЗройрпНро▒рпБ роиро╛ройрпН роЙроЩрпНроХро│рпБроХрпНроХрпБ роОрокрпНрокроЯро┐ роЙродро╡ роорпБроЯро┐ропрпБроорпН? роирпАроЩрпНроХро│рпН роОройрпНройро┐роЯроорпН роОродрпБро╡рпБроорпН роХрпЗроЯрпНроХро▓ро╛роорпН роЕро▓рпНро▓родрпБ роЯро┐роХрпНроХрпЖроЯрпН ро╡ро╛роЩрпНроХ \'роЯро┐роХрпНроХрпЖроЯрпН роорпБройрпНрокродро┐ро╡рпБ\' роХрпНроХрпБ рооро╛ро▒ро▓ро╛роорпН.',
    welcomeBooking: 'роЯро┐роХрпНроХрпЖроЯрпН роорпБройрпНрокродро┐ро╡рпБроХрпНроХрпБ ро╡ро░ро╡рпЗро▒рпНроХро┐ро▒рпЛроорпН. родрпКроЯроЩрпНроХ роТро░рпБ рооро╛роиро┐ро▓родрпНродрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН.',
    welcomeFaq: 'роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроЩрпНроХро│рпН роЕро▓рпНро▓родрпБ рокрпКродрпБро╡ро╛рой родро▓рпИрокрпНрокрпБроХро│рпН рокро▒рпНро▒ро┐ роирпАроЩрпНроХро│рпН роОройрпНройро┐роЯроорпН роОродрпБро╡рпБроорпН роХрпЗроЯрпНроХро▓ро╛роорпН.',
    bookingMode: 'роЯро┐роХрпНроХрпЖроЯрпН роорпБройрпНрокродро┐ро╡рпБ',
    faqMode: 'роХрпЗро│рпНро╡ро┐ роХрпЗро│рпБроЩрпНроХро│рпН',
    askMeAnything: 'роОройрпНройро┐роЯроорпН роОродрпБро╡рпБроорпН роХрпЗро│рпБроЩрпНроХро│рпН...',
    selectState: 'роЕро▒рпНрокрпБродроорпН! роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроЩрпНроХро│рпИроХрпН роХро╛рог роТро░рпБ рооро╛роиро┐ро▓родрпНродрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН.',
    selectMuseum: 'роЕро▒рпНрокрпБродроорпН! рокроЯрпНроЯро┐ропро▓ро┐ро▓ро┐ро░рпБроирпНродрпБ роТро░рпБ роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХродрпНродрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН.',
    chooseExperience: 'роЕро░рпБроорпИ! роирпАроЩрпНроХро│рпН роОроирпНрод роЕройрпБрокро╡родрпНродро┐ро▓рпН роЖро░рпНро╡рооро╛роХ роЙро│рпНро│рпАро░рпНроХро│рпН?',
    generalAdmission: 'рокрпКродрпБ роЕройрпБроородро┐',
    specialExhibition: 'роЪро┐ро▒рокрпНрокрпБ роХрогрпНроХро╛роЯрпНроЪро┐: "роХро╛ро╕рпНроорпЛро╕рпН"',
    selectDate: 'роЙроЩрпНроХро│рпН ро╡ро░рпБроХрпИроХрпНроХро╛рой родрпЗродро┐ропрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН.',
    selectTime: 'роЕро░рпБроорпИ! роирпЗро░родрпНродрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН.',
    selectQuantity: 'роЙроЩрпНроХро│рпБроХрпНроХрпБ роОродрпНродройрпИ роЯро┐роХрпНроХрпЖроЯрпНроЯрпБроХро│рпН родрпЗро╡рпИ?',
    adult: 'рокрпЖро░ро┐ропро╡ро░рпН',
    child: 'роХрпБро┤роирпНродрпИ',
    proceedToPayment: 'рокрогроорпН роЪрпЖро▓рпБродрпНрод родрпКроЯро░ро╡рпБроорпН',
    orderSummary: 'роЙроЩрпНроХро│рпН роЖро░рпНроЯро░рпН роЪрпБро░рпБроХрпНроХроорпН роЗродрпЛ:',
    paymentSuccessful: 'рокрогроорпН роЪрпЖро▓рпБродрпНродрпБродро▓рпН ро╡рпЖро▒рпНро▒ро┐! ЁЯОЙ',
    ticketIssued: 'роЙроЩрпНроХро│рпН роЯро┐роЬро┐роЯрпНроЯро▓рпН роЯро┐роХрпНроХрпЖроЯрпН родропро╛ро░ро╛роХ роЙро│рпНро│родрпБ. роЙроЩрпНроХро│рпИ роЪроирпНродро┐рокрпНрокродрпИ роиро╛роЩрпНроХро│рпН роЖро╡ро▓рпБроЯройрпН роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХро┐ро▒рпЛроорпН!',
    times: ['роХро╛ро▓рпИ 10:00', 'роородро┐ропроорпН 12:00', 'роородро┐ропроорпН 2:00', 'рооро╛ро▓рпИ 4:00'],
    states: {
        'роЯрпЖро▓рпНро▓ро┐': ['родрпЗроЪро┐роп роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, рокрпБродрпБ роЯрпЖро▓рпНро▓ро┐'],
        'роорпЗро▒рпНроХрпБ ро╡роЩрпНроХроорпН': ['роЗроирпНродро┐роп роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, роХрпКро▓рпНроХродрпНродро╛'],
        'родрпЖро▓рпБроЩрпНроХро╛ройро╛': ['роЪро╛ро▓ро╛ро░рпН роЬроЩрпН роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, ро╣рпИродро░ро╛рокро╛родрпН'],
        'роороХро╛ро░ро╛ро╖рпНроЯро┐ро░ро╛': ['роЪродрпНро░рокродро┐ роЪро┐ро╡ро╛роЬро┐ роороХро╛ро░ро╛роЬрпН р▓╡р▓╕р│Нр▓др│Б роЪроЩрпНроХро░ро╛ро▓ропро╛, роорпБроорпНрокрпИ'],
        'роХро░рпНроиро╛роЯроХро╛': ['ро╡ро┐ро╕рпНро╡рпЗро╕рпНро╡ро░ропро╛ родрпКро┤ро┐ро▓рпНродрпБро▒рпИ рооро▒рпНро▒рпБроорпН родрпКро┤ро┐ро▓рпНроирпБроЯрпНрок роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, рокрпЖроЩрпНроХро│рпВро░рпБ'],
        'родрооро┐ро┤рпНроиро╛роЯрпБ': ['роЕро░роЪрпБ роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, роЪрпЖройрпНройрпИ'],
        'ро░ро╛роЬро╕рпНродро╛ройрпН': ['роЖро▓рпНрокро░рпНроЯрпН ро╣ро╛ро▓рпН роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, роЬрпЖропрпНрокрпНрокрпВро░рпН'],
        'роЙродрпНродро░рокрпНрокро┐ро░родрпЗроЪроорпН': ['роЖройроирпНрод рокро╡ройрпН роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, рокро┐ро░ропро╛роХрпНро░ро╛роЬрпН'],
        'роХрпБроЬро░ро╛родрпН': ['роХро╛ро▓ро┐роХрпЛ роЯрпЖроХрпНро╕рпНроЯрпИро▓рпНро╕рпН роЕро░рпБроЩрпНроХро╛роЯрпНроЪро┐ропроХроорпН, роЕроХроородро╛рокро╛родрпН'],
    }
  },
  te: {
    welcome: 'р░ир░ор░╕р▒Нр░Хр░╛р░░р░В! р░ир▒Зр░ир▒Б р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В р░мр░бр▒Нр░бр▒Ар░ир░┐. р░И р░░р▒Лр░Ьр▒Б р░ир▒Зр░ир▒Б р░ор▒Ар░Хр▒Б р░Ор░▓р░╛ р░╕р░╣р░╛р░пр░кр░бр░Чр░▓р░ир▒Б? р░ор▒Ар░░р▒Б р░ир░ир▒Нр░ир▒Б р░Пр░жр▒Ир░ир░╛ р░Ер░бр░Чр░╡р░Ър▒Нр░Ър▒Б р░▓р▒Зр░жр░╛ р░Яр░┐р░Хр▒Нр░Хр▒Жр░Яр▒Нр░▓р▒Б р░Хр▒Кр░ир░бр░╛р░ир░┐р░Хр░┐ \'р░Яр░┐р░Хр▒Жр░Яр▒Н р░мр▒Бр░Хр░┐р░Вр░Чр▒Н\'р░Хр▒Б р░ор░╛р░░р░╡р░Ър▒Нр░Ър▒Б.',
    welcomeBooking: 'р░Яр░┐р░Хр▒Жр░Яр▒Н р░мр▒Бр░Хр░┐р░Вр░Чр▒НтАМр░Хр▒Б р░╕р▒Нр░╡р░╛р░Чр░др░В. р░кр▒Нр░░р░╛р░░р░Вр░нр░┐р░Вр░Ър░бр░╛р░ир░┐р░Хр░┐ р░жр░пр░Ър▒Зр░╕р░┐ р░Тр░Х р░░р░╛р░╖р▒Нр░Яр▒Нр░░р░╛р░ир▒Нр░ир░┐ р░Ор░Вр░Ър▒Бр░Хр▒Лр░Вр░бр░┐.',
    welcomeFaq: 'р░ор▒Ар░░р▒Б р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░Вр░▓р▒Б р░▓р▒Зр░жр░╛ р░╕р░╛р░зр░╛р░░р░г р░Ер░Вр░╢р░╛р░▓ р░Чр▒Бр░░р░┐р░Вр░Ър░┐ р░ир░ир▒Нр░ир▒Б р░Пр░жр▒Ир░ир░╛ р░Ер░бр░Чр░╡р░Ър▒Нр░Ър▒Б.',
    bookingMode: 'р░Яр░┐р░Хр▒Жр░Яр▒Н р░мр▒Бр░Хр░┐р░Вр░Чр▒Н',
    faqMode: 'р░кр▒Нр░░р░╢р▒Нр░и р░Ер░бр░Чр░Вр░бр░┐',
    askMeAnything: 'р░ир░ир▒Нр░ир▒Б р░Пр░жр▒Ир░ир░╛ р░Ер░бр░Чр░Вр░бр░┐...',
    selectState: 'р░Ер░жр▒Нр░нр▒Бр░др░В! р░Ер░Вр░жр▒Бр░мр░╛р░Яр▒Бр░▓р▒Л р░Йр░ир▒Нр░и р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░Вр░▓р░ир▒Б р░Ър▒Вр░бр░Яр░╛р░ир░┐р░Хр░┐ р░жр░пр░Ър▒Зр░╕р░┐ р░Тр░Х р░░р░╛р░╖р▒Нр░Яр▒Нр░░р░╛р░ир▒Нр░ир░┐ р░Ор░Вр░Ър▒Бр░Хр▒Лр░Вр░бр░┐.',
    selectMuseum: 'р░Ер░жр▒Нр░нр▒Бр░др░В! р░жр░пр░Ър▒Зр░╕р░┐ р░Ьр░╛р░мр░┐р░др░╛ р░ир▒Бр░Вр░бр░┐ р░Тр░Х р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░Вр░ир▒Б р░Ор░Вр░Ър▒Бр░Хр▒Лр░Вр░бр░┐.',
    chooseExperience: 'р░Ер░жр▒Нр░нр▒Бр░др░В! р░ор▒Ар░░р▒Б р░П р░Ер░ир▒Бр░нр░╡р░Вр░▓р▒Л р░Жр░╕р░Хр▒Нр░др░┐р░Чр░╛ р░Йр░ир▒Нр░ир░╛р░░р▒Б?',
    generalAdmission: 'р░╕р░╛р░зр░╛р░░р░г р░кр▒Нр░░р░╡р▒Зр░╢р░В',
    specialExhibition: 'р░кр▒Нр░░р░др▒Нр░пр▒Зр░Х р░кр▒Нр░░р░жр░░р▒Нр░╢р░и: "р░Хр░╛р░╕р▒Нр░ор▒Лр░╕р▒Н"',
    selectDate: 'р░ор▒А р░╕р░Вр░жр░░р▒Нр░╢р░и р░Хр▒Лр░╕р░В р░жр░пр░Ър▒Зр░╕р░┐ р░Тр░Х р░др▒Зр░жр▒Ар░ир░┐ р░Ор░Вр░Ър▒Бр░Хр▒Лр░Вр░бр░┐.',
    selectTime: 'р░Ер░жр▒Нр░нр▒Бр░др░В! р░жр░пр░Ър▒Зр░╕р░┐ р░Тр░Х р░╕р░ор░п р░╕р▒Нр░▓р░╛р░Яр▒НтАМр░ир▒Б р░Ор░Вр░Ър▒Бр░Хр▒Лр░Вр░бр░┐.',
    selectQuantity: 'р░ор▒Ар░Хр▒Б р░Ор░ир▒Нр░ир░┐ р░Яр░┐р░Хр▒Нр░Хр▒Жр░Яр▒Нр░▓р▒Б р░Хр░╛р░╡р░╛р░▓р░┐?',
    adult: 'р░кр▒Жр░жр▒Нр░жр░▓р▒Б',
    child: 'р░кр░┐р░▓р▒Нр░▓р░▓р▒Б',
    proceedToPayment: 'р░Ър▒Жр░▓р▒Нр░▓р░┐р░Вр░кр▒Бр░Хр▒Б р░Хр▒Кр░ир░╕р░╛р░Чр░Вр░бр░┐',
    orderSummary: 'р░Зр░жр░┐р░Чр▒Л р░ор▒А р░Жр░░р▒Нр░бр░░р▒Н р░╕р░╛р░░р░╛р░Вр░╢р░В:',
    paymentSuccessful: 'р░Ър▒Жр░▓р▒Нр░▓р░┐р░Вр░кр▒Б р░╡р░┐р░Ьр░пр░╡р░Вр░др░ор▒Ир░Вр░жр░┐! ЁЯОЙ',
    ticketIssued: 'р░ор▒А р░бр░┐р░Ьр░┐р░Яр░▓р▒Н р░Яр░┐р░Хр▒Жр░Яр▒Н р░╕р░┐р░жр▒Нр░зр░Вр░Чр░╛ р░Йр░Вр░жр░┐. р░ор░┐р░ор▒Нр░ор░▓р▒Нр░ир░┐ р░Ър▒Вр░бр░Яр░╛р░ир░┐р░Хр░┐ р░ор▒Зр░ор▒Б р░Ор░жр▒Бр░░р▒Бр░Ър▒Вр░╕р▒Нр░др▒Бр░ир▒Нр░ир░╛р░ор▒Б!',
    times: ['р░Йр░жр░пр░В 10:00', 'р░ор░зр▒Нр░пр░╛р░╣р▒Нр░ир░В 12:00', 'р░ор░зр▒Нр░пр░╛р░╣р▒Нр░ир░В 2:00', 'р░╕р░╛р░пр░Вр░др▒Нр░░р░В 4:00'],
    states: {
        'р░вр░┐р░▓р▒Нр░▓р▒А': ['р░Ьр░╛р░др▒Ар░п р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В, р░ир▒Нр░пр▒Вр░вр░┐р░▓р▒Нр░▓р▒А'],
        'р░кр░╢р▒Нр░Ър░┐р░о р░мр▒Жр░Вр░Чр░╛р░▓р▒Н': ['р░Зр░Вр░бр░┐р░пр░ир▒Н р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В, р░Хр▒Лр░▓р▒НтАМр░Хр░др░╛'],
        'р░др▒Жр░▓р░Вр░Чр░╛р░г': ['р░╕р░╛р░▓р░╛р░░р▒Н р░Ьр░Вр░Чр▒Н р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В, р░╣р▒Ир░жр░░р░╛р░мр░╛р░жр▒Н'],
        'р░ор░╣р░╛р░░р░╛р░╖р▒Нр░Яр▒Нр░░': ['р░Ыр░др▒Нр░░р░кр░др░┐ р░╢р░┐р░╡р░╛р░Ьр▒А р░ор░╣р░╛р░░р░╛р░Ьр▒Н р░╡р░╛р░╕р▒Нр░др▒Б р░╕р░Вр░Чр▒Нр░░р░╣р░╛р░▓р░пр░В, р░ор▒Бр░Вр░мр▒И'],
        'р░Хр░░р▒Нр░гр░╛р░Яр░Х': ['р░╡р░┐р░╢р▒Нр░╡р▒Зр░╢р▒Нр░╡р░░р░пр▒Нр░п р░Зр░Вр░бр░╕р▒Нр░Яр▒Нр░░р░┐р░пр░▓р▒Н & р░Яр▒Жр░Хр▒Нр░ир░▓р░╛р░Ьр░┐р░Хр░▓р▒Н р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В, р░мр▒Жр░Вр░Чр░│р▒Вр░░р▒Б'],
        'р░др░ор░┐р░│р░ир░╛р░бр▒Б': ['р░кр▒Нр░░р░нр▒Бр░др▒Нр░╡ р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В, р░Ър▒Жр░ир▒Нр░ир▒И'],
        'р░░р░╛р░Ьр░╕р▒Нр░ер░╛р░ир▒Н': ['р░Жр░▓р▒Нр░мр░░р▒Нр░Яр▒Н р░╣р░╛р░▓р▒Н р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В, р░Ьр▒Ир░кр▒Вр░░р▒Н'],
        'р░Йр░др▒Нр░др░░ р░кр▒Нр░░р░жр▒Зр░╢р▒Н': ['р░Жр░ир░Вр░жр▒Н р░нр░╡р░ир▒Н р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В, р░кр▒Нр░░р░пр░╛р░Чр▒НтАМр░░р░╛р░Ьр▒Н'],
        'р░Чр▒Бр░Ьр░░р░╛р░др▒Н': ['р░Хр░╛р░▓р░┐р░Хр▒Л р░ор▒Нр░пр▒Вр░Ьр░┐р░пр░В р░Жр░лр▒Н р░Яр▒Жр░Хр▒Нр░╕р▒НтАМр░Яр▒Ир░▓р▒Нр░╕р▒Н, р░Ер░╣р▒Нр░ор░жр░╛р░мр░╛р░жр▒Н'],
    }
  },
  kn: {
    welcome: 'р▓ир▓ор▓╕р│Нр▓Хр▓╛р▓░! р▓ир▓╛р▓ир│Б р▓ор│Нр▓пр│Вр▓╕р▓┐р▓пр▓В р▓мр▓бр│Нр▓бр▓┐. р▓Зр▓Вр▓жр│Б р▓ир▓╛р▓ир│Б р▓ир▓┐р▓ор▓Чр│Ж р▓╣р│Зр▓Чр│Ж р▓╕р▓╣р▓╛р▓п р▓ор▓╛р▓бр▓мр▓╣р│Бр▓жр│Б? р▓ир│Ар▓╡р│Б р▓ир▓ир│Нр▓ир▓ир│Нр▓ир│Б р▓Пр▓ир│Б р▓мр│Зр▓Хр▓╛р▓жр▓░р│В р▓Хр│Зр▓│р▓мр▓╣р│Бр▓жр│Б р▓Ер▓ер▓╡р▓╛ р▓Яр▓┐р▓Хр│Жр▓Яр│Н р▓Цр▓░р│Ар▓жр▓┐р▓╕р▓▓р│Б \'р▓Яр▓┐р▓Хр│Жр▓Яр│Н р▓мр│Бр▓Хр▓┐р▓Вр▓Чр│Н\'р▓Чр│Ж р▓мр▓жр▓▓р▓╛р▓пр▓┐р▓╕р▓мр▓╣р│Бр▓жр│Б.',
    welcomeBooking: 'р▓Яр▓┐р▓Хр│Жр▓Яр│Н р▓мр│Бр▓Хр▓┐р▓Вр▓Чр│НтАМр▓Чр│Ж р▓╕р│Бр▓╕р│Нр▓╡р▓╛р▓Чр▓д. р▓кр│Нр▓░р▓╛р▓░р▓Вр▓нр▓┐р▓╕р▓▓р│Б р▓жр▓пр▓╡р▓┐р▓Яр│Нр▓Яр│Б р▓░р▓╛р▓Ьр│Нр▓пр▓╡р▓ир│Нр▓ир│Б р▓Жр▓пр│Нр▓Хр│Жр▓ор▓╛р▓бр▓┐.',
    welcomeFaq: 'р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓пр▓Чр▓│р│Б р▓Ер▓ер▓╡р▓╛ р▓╕р▓╛р▓ор▓╛р▓ир│Нр▓п р▓╡р▓┐р▓╖р▓пр▓Чр▓│ р▓мр▓Чр│Нр▓Чр│Ж р▓ир│Ар▓╡р│Б р▓ир▓ир│Нр▓ир▓ир│Нр▓ир│Б р▓Пр▓ир│Б р▓мр│Зр▓Хр▓╛р▓жр▓░р│В р▓Хр│Зр▓│р▓мр▓╣р│Бр▓жр│Б.',
    bookingMode: 'р▓Яр▓┐р▓Хр│Жр▓Яр│Н р▓мр│Бр▓Хр▓┐р▓Вр▓Чр│Н',
    faqMode: 'р▓кр│Нр▓░р▓╢р│Нр▓ир│Ж р▓Хр│Зр▓│р▓┐',
    askMeAnything: 'р▓ир▓ир│Нр▓ир▓ир│Нр▓ир│Б р▓Пр▓ир│Б р▓мр│Зр▓Хр▓╛р▓жр▓░р│В р▓Хр│Зр▓│р▓┐...',
    selectState: 'р▓Ер▓жр│Нр▓нр│Бр▓д! р▓▓р▓нр│Нр▓пр▓╡р▓┐р▓░р│Бр▓╡ р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓пр▓Чр▓│р▓ир│Нр▓ир│Б р▓ир│Лр▓бр▓▓р│Б р▓жр▓пр▓╡р▓┐р▓Яр│Нр▓Яр│Б р▓░р▓╛р▓Ьр│Нр▓пр▓╡р▓ир│Нр▓ир│Б р▓Жр▓пр│Нр▓Хр│Жр▓ор▓╛р▓бр▓┐.',
    selectMuseum: 'р▓Ер▓жр│Нр▓нр│Бр▓д! р▓жр▓пр▓╡р▓┐р▓Яр│Нр▓Яр│Б р▓кр▓Яр│Нр▓Яр▓┐р▓пр▓┐р▓Вр▓ж р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓пр▓╡р▓ир│Нр▓ир│Б р▓Жр▓пр│Нр▓Хр│Жр▓ор▓╛р▓бр▓┐.',
    chooseExperience: 'р▓Ер▓жр│Нр▓нр│Бр▓д! р▓ир│Ар▓╡р│Б р▓пр▓╛р▓╡ р▓Ер▓ир│Бр▓нр▓╡р▓жр▓▓р│Нр▓▓р▓┐ р▓Жр▓╕р▓Хр│Нр▓др▓┐ р▓╣р│Кр▓Вр▓жр▓┐р▓жр│Нр▓жр│Ар▓░р▓┐?',
    generalAdmission: 'р▓╕р▓╛р▓ор▓╛р▓ир│Нр▓п р▓кр│Нр▓░р▓╡р│Зр▓╢',
    specialExhibition: 'р▓╡р▓┐р▓╢р│Зр▓╖ р▓кр│Нр▓░р▓жр▓░р│Нр▓╢р▓и: "р▓мр│Нр▓░р▓╣р│Нр▓ор▓╛р▓Вр▓б"',
    selectDate: 'р▓жр▓пр▓╡р▓┐р▓Яр│Нр▓Яр│Б р▓ир▓┐р▓ор│Нр▓о р▓нр│Зр▓Яр▓┐р▓Чр▓╛р▓Чр▓┐ р▓жр▓┐р▓ир▓╛р▓Вр▓Хр▓╡р▓ир│Нр▓ир│Б р▓Жр▓пр│Нр▓Хр│Жр▓ор▓╛р▓бр▓┐.',
    selectTime: 'р▓Ер▓др│Нр▓пр│Бр▓др│Нр▓др▓о! р▓жр▓пр▓╡р▓┐р▓Яр│Нр▓Яр│Б р▓╕р▓ор▓пр▓ж р▓╕р│Нр▓▓р▓╛р▓Яр│Н р▓Жр▓пр│Нр▓Хр│Жр▓ор▓╛р▓бр▓┐.',
    selectQuantity: 'р▓ир▓┐р▓ор▓Чр│Ж р▓Ор▓╖р│Нр▓Яр│Б р▓Яр▓┐р▓Хр│Жр▓Яр│НтАМр▓Чр▓│р│Б р▓мр│Зр▓Хр│Б?',
    adult: 'р▓╡р▓пр▓╕р│Нр▓Х',
    child: 'р▓ор▓Чр│Б',
    proceedToPayment: 'р▓кр▓╛р▓╡р▓др▓┐р▓Чр│Ж р▓ор│Бр▓Вр▓жр│Бр▓╡р▓░р▓┐р▓пр▓┐р▓░р▓┐',
    orderSummary: 'р▓ир▓┐р▓ор│Нр▓о р▓Жр▓жр│Зр▓╢р▓ж р▓╕р▓╛р▓░р▓╛р▓Вр▓╢ р▓Зр▓▓р│Нр▓▓р▓┐р▓жр│Ж:',
    paymentSuccessful: 'р▓кр▓╛р▓╡р▓др▓┐ р▓пр▓╢р▓╕р│Нр▓╡р▓┐р▓пр▓╛р▓Чр▓┐р▓жр│Ж! ЁЯОЙ',
    ticketIssued: 'р▓ир▓┐р▓ор│Нр▓о р▓бр▓┐р▓Ьр▓┐р▓Яр▓▓р│Н р▓Яр▓┐р▓Хр│Жр▓Яр│Н р▓╕р▓┐р▓жр│Нр▓зр▓╡р▓╛р▓Чр▓┐р▓жр│Ж. р▓ир▓┐р▓ор│Нр▓ор▓ир│Нр▓ир│Б р▓ир│Лр▓бр▓▓р│Б р▓ир▓╛р▓╡р│Б р▓Ор▓жр│Бр▓░р│Б р▓ир│Лр▓бр│Бр▓др│Нр▓др▓┐р▓жр│Нр▓жр│Зр▓╡р│Ж!',
    times: ['р▓мр│Жр▓│р▓┐р▓Чр│Нр▓Чр│Ж 10:00', 'р▓ор▓зр│Нр▓пр▓╛р▓╣р│Нр▓и 12:00', 'р▓ор▓зр│Нр▓пр▓╛р▓╣р│Нр▓и 2:00', 'р▓╕р▓Вр▓Ьр│Ж 4:00'],
    states: {
        'р▓жр│Жр▓╣р▓▓р▓┐': ['р▓░р▓╛р▓╖р│Нр▓Яр│Нр▓░р│Ар▓п р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓п, р▓ир▓╡р▓жр│Жр▓╣р▓▓р▓┐'],
        'р▓кр▓╢р│Нр▓Ър▓┐р▓о р▓мр▓Вр▓Чр▓╛р▓│': ['р▓нр▓╛р▓░р▓др│Ар▓п р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓п, р▓Хр│Лр▓▓р│Нр▓Хр▓др│Нр▓др▓╛'],
        'р▓др│Жр▓▓р▓Вр▓Чр▓╛р▓г': ['р▓╕р▓╛р▓▓р▓╛р▓░р│Н р▓Ьр▓Вр▓Чр│Н р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓п, р▓╣р│Ир▓жр▓░р▓╛р▓мр▓╛р▓жр│Н'],
        'р▓ор▓╣р▓╛р▓░р▓╛р▓╖р│Нр▓Яр│Нр▓░': ['р▓Ыр▓др│Нр▓░р▓кр▓др▓┐ р▓╢р▓┐р▓╡р▓╛р▓Ьр▓┐ р▓ор▓╣р▓╛р▓░р▓╛р▓Ьр│Н р▓╡р▓╕р│Нр▓др│Б р▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓п, р▓ор│Бр▓Вр▓мр│И'],
        'р▓Хр▓░р│Нр▓ир▓╛р▓Яр▓Х': ['р▓╡р▓┐р▓╢р│Нр▓╡р│Зр▓╢р│Нр▓╡р▓░р▓пр│Нр▓п р▓Хр│Ир▓Чр▓╛р▓░р▓┐р▓Хр▓╛ р▓ор▓др│Нр▓др│Б р▓др▓╛р▓Вр▓др│Нр▓░р▓┐р▓Х р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓п, р▓мр│Жр▓Вр▓Чр▓│р│Вр▓░р│Б'],
        'р▓др▓ор▓┐р▓│р│Бр▓ир▓╛р▓бр│Б': ['р▓╕р▓░р│Нр▓Хр▓╛р▓░р▓┐ р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓п, р▓Ър│Жр▓ир│Нр▓ир│И'],
        'р▓░р▓╛р▓Ьр▓╕р│Нр▓ер▓╛р▓и': ['р▓Жр▓▓р│Нр▓мр▓░р│Нр▓Яр│Н р▓╣р▓╛р▓▓р│Н р▓ор│Нр▓пр│Вр▓╕р▓┐р▓пр▓В, р▓Ьр│Ир▓кр│Бр▓░'],
        'р▓Йр▓др│Нр▓др▓░ р▓кр│Нр▓░р▓жр│Зр▓╢': ['р▓Жр▓ир▓Вр▓ж р▓нр▓╡р▓и р▓╡р▓╕р│Нр▓др│Бр▓╕р▓Вр▓Чр│Нр▓░р▓╣р▓╛р▓▓р▓п, р▓кр│Нр▓░р▓пр▓╛р▓Чр│НтАМр▓░р▓╛р▓Ьр│Н'],
        'р▓Чр│Бр▓Ьр▓░р▓╛р▓др│Н': ['р▓Хр│Нр▓пр▓╛р▓▓р▓┐р▓Хр│К р▓ор│Нр▓пр│Вр▓╕р▓┐р▓пр▓В р▓Жр▓лр│Н р▓Яр│Жр▓Хр│Нр▓╕р│НтАМр▓Яр│Ир▓▓р│Нр▓╕р│Н, р▓Ер▓╣р▓ор▓жр▓╛р▓мр▓╛р▓жр│Н'],
    }
  },
};

type ChatStep =
  | 'start' | 'select_state' | 'select_museum' | 'select_experience' | 'select_date' | 'select_time'
  | 'select_quantity' | 'confirm_order' | 'payment' | 'ticket_issued';

type ChatMode = 'booking' | 'faq';

export default function ChatInterface({ lang }: { lang: 'en' | 'hi' | 'bn' | 'ta' | 'te' | 'kn' }) {
  const t = translations[lang];
  const [messages, setMessages] = useState<Message[]>([]);
  const [step, setStep] = useState<ChatStep>('start');
  const [mode, setMode] = useState<ChatMode>('faq');
  const [order, setOrder] = useState<TicketOrder>({
    state: null,
    museum: null,
    type: null,
    date: null,
    time: null,
    tickets: { adult: 1, child: 0 },
  });
  const [isBotTyping, setIsBotTyping] = useState(false);
  const scrollAreaRef = useRef<HTMLDivElement>(null);

  const addMessage = (sender: 'user' | 'bot', content: React.ReactNode) => {
    const id = `${Date.now()}-${Math.random()}`;
    setMessages(prev => [...prev, { id, sender, content }]);
    if (sender === 'user') {
      setIsBotTyping(true);
    }
  };
  
  const handleBotResponse = (callback: () => void, delay?: number) => {
    setTimeout(() => {
      setIsBotTyping(false);
      callback();
    }, delay ?? 1000 + Math.random() * 500);
  }

  useEffect(() => {
    if (scrollAreaRef.current) {
      scrollAreaRef.current.scrollTop = scrollAreaRef.current.scrollHeight;
    }
  }, [messages, isBotTyping]);
  
  const resetChat = (newMode: ChatMode) => {
    setMessages([]);
    if (newMode === 'booking') {
        addMessage('bot', t.welcomeBooking);
        setStep('select_state');
    } else {
        if (messages.length === 0) {
            addMessage('bot', t.welcome);
        }
        setStep('start');
    }
  }

  useEffect(() => {
    resetChat(mode);
  // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [mode, lang]);

  const handleModeChange = (newMode: ChatMode) => {
    if (mode !== newMode) {
      setMode(newMode);
    }
  };
  
  const handleFaqQuestion = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    const formData = new FormData(e.currentTarget);
    const question = formData.get('question') as string;
    if (!question) return;

    addMessage('user', question);
    e.currentTarget.reset();
    
    handleBotResponse(async () => {
      const result = await getAnswer({question, lang});
      if (result.intent === 'SWITCH_TO_BOOKING') {
        addMessage('bot', result.answer);
        handleBotResponse(() => handleModeChange('booking'));
      } else {
        addMessage('bot', result.answer);
      }
    }, 0);
  }
  
  const handleStateSelection = (state: string) => {
    addMessage('user', state);
    setOrder(prev => ({ ...prev, state }));
    handleBotResponse(() => {
      addMessage('bot', t.selectMuseum);
      setStep('select_museum');
    });
  };

  const handleMuseumSelection = (museum: string) => {
    addMessage('user', museum);
    setOrder(prev => ({ ...prev, museum }));
    handleBotResponse(() => {
        addMessage('bot', t.chooseExperience);
        setStep('select_experience');
    });
  }

  const handleExperienceSelection = (selection: 'general' | 'special') => {
    const experienceText = selection === 'general' ? t.generalAdmission : t.specialExhibition;
    addMessage('user', experienceText);
    setOrder(prev => ({ ...prev, type: selection === 'general' ? 'General Admission' : 'Special Exhibition: "Cosmos"' }));
    handleBotResponse(() => {
      addMessage('bot', t.selectDate);
      setStep('select_date');
    });
  };

  const handleDateSelection = (date: Date | undefined) => {
    if (!date) return;
    addMessage('user', date.toLocaleDateString(lang));
    setOrder(prev => ({ ...prev, date }));
    handleBotResponse(() => {
      addMessage('bot', t.selectTime);
      setStep('select_time');
    });
  };

  const handleTimeSelection = (time: string) => {
    addMessage('user', time);
    setOrder(prev => ({ ...prev, time }));
    handleBotResponse(() => {
      addMessage('bot', t.selectQuantity);
      setStep('select_quantity');
    });
  };
  
  const handleQuantityChange = (type: 'adult' | 'child', value: number) => {
    setOrder(prev => ({ ...prev, tickets: { ...prev.tickets, [type]: Math.max(0, value) }}));
  }

  const handleConfirmQuantity = () => {
    addMessage('user', `${order.tickets.adult} ${t.adult}, ${order.tickets.child} ${t.child}`);
    handleBotResponse(() => {
      addMessage('bot', <div><p>{t.orderSummary}</p><TicketSummary order={order} lang={lang} /></div>);
      setStep('confirm_order');
    });
  }
  
  const handlePayment = () => {
    addMessage('user', t.proceedToPayment);
    handleBotResponse(() => setStep('payment'));
  }
  
  const handlePaymentSuccess = () => {
    addMessage('bot', t.paymentSuccessful);
    handleBotResponse(() => {
        addMessage('bot', <div><p>{t.ticketIssued}</p><DigitalTicket order={order} lang={lang} /></div>);
        setStep('ticket_issued');
    });
  }
  
  const renderModeToggle = () => (
    <div className="flex justify-center p-2">
        <div className="flex items-center gap-1 rounded-full border bg-card p-1">
            <Button 
                variant={mode === 'booking' ? 'default' : 'ghost'}
                size="sm"
                onClick={() => handleModeChange('booking')}
                className={cn('rounded-full', {'shadow-sm': mode === 'booking'})}
            >
                <Ticket className="mr-2" />{t.bookingMode}
            </Button>
            <Button 
                variant={mode === 'faq' ? 'default' : 'ghost'}
                size="sm"
                onClick={() => handleModeChange('faq')}
                className={cn('rounded-full', {'shadow-sm': mode === 'faq'})}
            >
                <MessageCircleQuestion className="mr-2" />{t.faqMode}
            </Button>
        </div>
    </div>
  );

  const renderInput = () => {
    if (mode === 'faq') {
        return (
            <form onSubmit={handleFaqQuestion} className="flex gap-2 p-2">
                <Input name="question" placeholder={t.askMeAnything} className="flex-1" />
                <Button type="submit" size="icon" className="soft-shadow">
                    <Send />
                </Button>
            </form>
        );
    }
    
    switch (step) {
      case 'select_state':
        return (
          <div className="grid grid-cols-1 gap-2 p-2 sm:grid-cols-2 md:grid-cols-3">
            {Object.keys(t.states).map(state => (
              <Button key={state} variant="secondary" onClick={() => handleStateSelection(state)} className="soft-shadow text-center">{state}</Button>
            ))}
          </div>
        );
      case 'select_museum':
        const museums = order.state ? t.states[order.state as keyof typeof t.states] : [];
        return (
          <div className="grid grid-cols-1 gap-2 p-2 sm:grid-cols-1">
            {museums.map(museum => <Button key={museum} variant="secondary" onClick={() => handleMuseumSelection(museum)} className="soft-shadow text-center">{museum}</Button>)}
          </div>
        );
      case 'select_experience':
        return (
          <div className="flex gap-2 p-2">
            <Button onClick={() => handleExperienceSelection('general')} className="w-full soft-shadow">{t.generalAdmission}</Button>
            <Button onClick={() => handleExperienceSelection('special')} variant="secondary" className="w-full soft-shadow">{t.specialExhibition}</Button>
          </div>
        );
      case 'select_date':
          return <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="flex justify-center"><Calendar mode="single" onSelect={handleDateSelection} className="m-4 rounded-lg border card-shadow" selected={order.date ?? undefined} /></motion.div>
      case 'select_time':
        return (
          <div className="grid grid-cols-2 gap-2 p-2">
            {t.times.map(time => <Button key={time} variant="secondary" onClick={() => handleTimeSelection(time)} className="soft-shadow">{time}</Button>)}
          </div>
        );
      case 'select_quantity':
        return (
            <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="space-y-4 rounded-md border bg-card p-4 card-shadow">
                <div className="flex items-center justify-between">
                    <span className="font-medium">{t.adult}</span>
                    <div className="flex items-center gap-2">
                        <Button size="icon" variant="outline" onClick={() => handleQuantityChange('adult', order.tickets.adult - 1)}>-</Button>
                        <span className="w-8 text-center">{order.tickets.adult}</span>
                        <Button size="icon" variant="outline" onClick={() => handleQuantityChange('adult', order.tickets.adult + 1)}>+</Button>
                    </div>
                </div>
                 <div className="flex items-center justify-between">
                    <span className="font-medium">{t.child}</span>
                    <div className="flex items-center gap-2">
                        <Button size="icon" variant="outline" onClick={() => handleQuantityChange('child', order.tickets.child - 1)}>-</Button>
                        <span className="w-8 text-center">{order.tickets.child}</span>
                        <Button size="icon" variant="outline" onClick={() => handleQuantityChange('child', order.tickets.child + 1)}>+</Button>
                    </div>
                </div>
                <Button onClick={handleConfirmQuantity} className="w-full soft-shadow">{t.proceedToPayment}</Button>
            </motion.div>
        );
      case 'confirm_order':
          return <div className="p-2"><Button onClick={handlePayment} className="w-full soft-shadow">{t.proceedToPayment}</Button></div>;
      case 'payment':
          return <PaymentDialog open={true} onPaymentSuccess={handlePaymentSuccess} onOpenChange={() => setStep('confirm_order')} />;
      case 'ticket_issued':
          return <div className="p-2 text-center text-sm text-muted-foreground">You can switch modes or start a new booking.</div>;
      default:
        return null;
    }
  };

  return (
    <div className="flex h-[calc(100vh-4rem)] flex-col">
      <div ref={scrollAreaRef} className="flex-1 overflow-y-auto p-4 space-y-4">
        <AnimatePresence>
            {messages.map(msg => (
                <motion.div key={msg.id} initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.3 }}>
                    <ChatBubble sender={msg.sender}>{msg.content}</ChatBubble>
                </motion.div>
            ))}
            {isBotTyping && <motion.div key="typing" initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.3 }}><ChatBubble sender="bot">...</ChatBubble></motion.div>}
        </AnimatePresence>
      </div>
      <div className="border-t bg-background">
        {renderModeToggle()}
        <div className="p-2">
            {renderInput()}
        </div>
      </div>
    </div>
  );
}
